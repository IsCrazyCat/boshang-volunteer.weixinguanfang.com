<include  file='public:header'/>
<div class="listBox clfx">
    <div class="menuManage">
        <form  target="baocms_frm" method="post">
            <div class="mainScAdd">
                <div class="tableBox">
                    <table bordercolor="#e1e6eb" cellspacing="0" width="100%" border="1px"  style=" border-collapse: collapse; margin:0px; vertical-align:middle; background-color:#FFF;" >
                        <tr>
                            <td class="lfTdBt">志愿者：</td>
                            <td  class="rgTdBt">
                                <input type="text" name="data[nickname]" value="<{$user['nickname']}>" class="manageInput" readonly="readonly"/>
                            </td>
                        </tr>
                        <tr>
                            <td class="lfTdBt">服务时长：</td>
                            <td  class="rgTdBt">
                                <input type="text" name="data[service_time]" value="<{$serviceInfo['service_time']}>" class="manageInput" readonly="readonly"/>
                            </td>
                        </tr>
                        <tr>
                            <td class="lfTdBt">增加时长：</td>
                            <td  class="rgTdBt">
                                <input type="text" name="data[add_service_time]" id="add_service_time" onchange="checkTime()" value="0" class="manageInput"/>小时
                            </td>
                        </tr>
                        <tr>
                            <td class="lfTdBt">备注：</td>
                            <td  class="rgTdBt">
                                <textarea name="data[add_service_msg]" id="add_service_msg" class="manageInput"></textarea>
                            </td>
                        </tr>

                    </table>
                </div>
                <div class="smtQr"><input type="button" id="subBtn" onclick="subClick()" value="确认添加" class="smtQrIpt" /></div>
            </div>
        </form>
    </div>
</div>
<script>
    function checkTime(){
        var add_time =  $("#add_time").val().trim();
        var add_service_time = $("#add_service_time").val();
        var reg=/^[1-9]\d*$/; //由 1-9开头 的正则表达式
        //先判断是否为整数
        if(reg.test(add_service_time)){

        }else{
            $("#add_service_time").val('0');
            alert('请输入整数');
        }

    }
    function subClick(){
        var add_service_time = $("#add_service_time").val();
        var add_service_msg = $("#add_service_msg").val();
        if(add_service_time>0){
            if(add_service_msg.trim()==''){
                alert("描述不能为空！");
                return false;
            }
            $.ajax({
                url:"<{:U('user/addServiceTime')}>",
                method:"POST",
                data:{
                    "user_id":'<{$user.user_id}>',
                    "add_service_time":add_service_time,
                    "add_service_msg":add_service_msg
                },
                success:function (data) {
                    if(data=='success'){
                        alert("增加时长成功！");
                        window.location.href = "/admin/user/index";
                    }else{
                        alert("增加时长失败！");
                    }
                }
            });
        }else{
            alert("增加时长不能小于1");
        }

    }
</script>
<include  file='public:footer'/>